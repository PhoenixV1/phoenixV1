<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phoenix Proxy | Stealth</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&display=swap" rel="stylesheet">
    
    <script src="/uv/uv.bundle.js" onerror="window.uvLoaded=false" onload="window.uvLoaded=true" defer></script>
    <script src="/uv/uv.config.js" defer></script>
    <script src="/scramject/scramject.bundle.js" onerror="window.sjLoaded=false" onload="window.sjLoaded=true" defer></script>

    <style>
        :root {
            --primary: #ff3c00;
            --primary-glow: rgba(255, 60, 0, 0.6);
            --bg-core: #0a0000;
            --secondary: #ff8c00;
        }

        body {
            margin: 0; padding: 0;
            font-family: 'Outfit', sans-serif;
            background: var(--bg-core);
            color: #eee;
            height: 100vh;
            display: flex;
            overflow: hidden;
            transition: background 0.5s ease;
        }

        .sidebar {
            width: 220px;
            background: rgba(10, 10, 10, 0.95);
            border-right: 1px solid var(--primary-glow);
            display: flex;
            flex-direction: column;
            padding: 1rem;
            gap: 0.5rem;
        }

        .tab-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.8rem 1rem;
            border-radius: 12px;
            font-size: 0.9rem;
            font-weight: 500;
            color: #555;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid transparent;
        }

        .tab-item:hover {
            background: var(--primary-glow);
            color: #bbb;
        }

        .tab-item.active {
            background: var(--primary-glow);
            color: var(--primary);
            border: 1px solid var(--primary-glow);
            font-weight: 700;
        }

        .main-view {
            flex: 1;
            display: flex;
            flex-direction: column;
            margin: 12px;
            background: #000;
            border-radius: 24px;
            overflow: hidden;
            border: 1px solid #1a0000;
            position: relative;
            box-shadow: 0 10px 40px rgba(0,0,0,0.8);
        }

        .toolbar {
            height: 56px;
            background: #0a0000;
            border-bottom: 1px solid var(--primary-glow);
            display: flex;
            align-items: center;
            padding: 0 1.5rem;
            gap: 1.5rem;
        }

        .address-input {
            flex: 1;
            background: #111;
            border-radius: 14px;
            height: 38px;
            display: flex;
            align-items: center;
            padding: 0 1.2rem;
            font-size: 0.9rem;
            color: var(--primary);
            border: 1px solid var(--primary-glow);
        }

        .address-input input {
            background: transparent;
            border: none;
            outline: none;
            width: 100%;
            color: inherit;
            font-weight: 600;
        }

        iframe {
            flex: 1;
            background: #000;
            border: none;
        }

        #status-msg {
            position: absolute;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.4em;
            color: var(--primary);
            opacity: 0.4;
        }

        .btn-cloak {
            background: var(--primary);
            color: #000;
            padding: 0.5rem 1.5rem;
            border-radius: 10px;
            font-weight: 900;
            text-transform: uppercase;
            font-size: 10px;
            letter-spacing: 0.1em;
            transition: all 0.2s;
            box-shadow: 0 0 15px var(--primary-glow);
        }

        .btn-cloak:hover {
            transform: scale(1.05);
            background: #fff;
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="flex items-center gap-3 mb-10 px-2">
            <a href="index.html" class="w-10 h-10 rounded-xl bg-white/5 border border-white/10 flex items-center justify-center text-current hover:scale-110 transition-transform" style="color: var(--primary)">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
            </a>
            <span class="text-[12px] font-black uppercase tracking-[0.2em]" style="color: var(--primary)">Stealth</span>
        </div>

        <div class="tab-item active">
            <div class="w-2.5 h-2.5 rounded-full flex-shrink-0" style="background: var(--primary); box-shadow: 0 0 10px var(--primary-glow)"></div>
            <span>Node Alpha</span>
        </div>
        <div class="tab-item" onclick="location.href='browser.html'">
            <div class="w-2.5 h-2.5 rounded-full bg-white/10"></div>
            <span>Nexus Browser</span>
        </div>
    </div>

    <div class="main-view">
        <div class="toolbar">
            <div class="flex gap-6 opacity-30">
                <svg onclick="history.back()" class="w-5 h-5 hover:text-white cursor-pointer transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="3" d="M15 19l-7-7 7-7"/></svg>
                <svg onclick="history.forward()" class="w-5 h-5 hover:text-white cursor-pointer transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-width="3" d="M9 5l7 7-7 7"/></svg>
            </div>
            <div class="address-input">
                <input type="text" placeholder="Ignite a URL to cloak..." id="proxy-input" spellcheck="false" autocomplete="off">
            </div>
            <button onclick="cloak()" class="btn-cloak">Cloak</button>
        </div>
        <iframe src="about:blank" id="uv-viewport"></iframe>
        <div id="status-msg">PHOENIX STEALTH INITIALIZING...</div>
    </div>

    <script>
        const fallbackThemes = {
            "themes": [
                { "id": "ember", "name": "Ember", "primary": "#ff3c00", "glow": "rgba(255, 60, 0, 0.6)", "bg": "#0a0000", "secondary": "#ff8c00" },
                { "id": "ocean", "name": "Ocean", "primary": "#00d4ff", "glow": "rgba(0, 212, 255, 0.6)", "bg": "#000814", "secondary": "#0077b6" },
                { "id": "dunes", "name": "Dunes", "primary": "#ffb703", "glow": "rgba(255, 183, 3, 0.6)", "bg": "#141000", "secondary": "#fb8500" },
                { "id": "lavender", "name": "Lavender", "primary": "#9d4edd", "glow": "rgba(157, 78, 221, 0.6)", "bg": "#10002b", "secondary": "#5a189a" },
                { "id": "forest", "name": "Forest", "primary": "#2dc653", "glow": "rgba(45, 198, 83, 0.6)", "bg": "#001a00", "secondary": "#1b4332" },
                { "id": "nebula", "name": "Nebula", "primary": "#ff00ff", "glow": "rgba(255, 0, 255, 0.6)", "bg": "#0d001a", "secondary": "#7000ff" },
                { "id": "aurora", "name": "Aurora", "primary": "#00ffcc", "glow": "rgba(0, 255, 204, 0.6)", "bg": "#000d0a", "secondary": "#7000ff" }
            ]
        };

        function setCSSVars(theme) {
            document.documentElement.style.setProperty('--primary', theme.primary);
            document.documentElement.style.setProperty('--primary-glow', theme.glow);
            document.documentElement.style.setProperty('--bg-core', theme.bg);
            document.documentElement.style.setProperty('--secondary', theme.secondary || theme.primary);
        }

        async function applyTheme() {
            const activeThemeId = localStorage.getItem('phoenix-theme') || 'ember';
            try {
                const r = await fetch('assets/themes/theme.json');
                if (!r.ok) throw new Error();
                const data = await r.json();
                const theme = data.themes.find(t => t.id === activeThemeId) || data.themes[0];
                setCSSVars(theme);
            } catch (e) {
                const theme = fallbackThemes.themes.find(t => t.id === activeThemeId) || fallbackThemes.themes[0];
                setCSSVars(theme);
            }
        }
        applyTheme();

        const input = document.getElementById('proxy-input');
        const iframe = document.getElementById('uv-viewport');
        const status = document.getElementById('status-msg');

        function cloak() {
            let url = input.value.trim();
            if (!url) return;

            if (!url.startsWith('http')) {
                if (url.includes('.') && !url.includes(' ')) {
                    url = 'https://' + url;
                } else {
                    url = `https://duckduckgo.com/?q=${encodeURIComponent(url)}`;
                }
            }

            const settings = JSON.parse(localStorage.getItem('phoenix-settings')) || { engine: 'uv' };
            
            if (settings.engine === 'uv' && window.uvLoaded) {
                status.innerText = "ULTRAVIOLET CLOAK ACTIVE";
                iframe.src = __uv$config.prefix + __uv$config.encodeUrl(url);
            } else if (settings.engine === 'sj' && window.sjLoaded) {
                status.innerText = "SCRAMJET CLOAK ACTIVE";
                iframe.src = '/sj/' + btoa(url);
            } else {
                status.innerText = "CORE SCRIPTS MISSING: DIRECT MODE";
                iframe.src = url;
            }
        }

        input.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') cloak();
        });

        setInterval(() => {
            const settings = JSON.parse(localStorage.getItem('phoenix-settings')) || { engine: 'uv' };
            const loaded = settings.engine === 'uv' ? window.uvLoaded : window.sjLoaded;
            if (loaded === false) {
                status.innerText = "WAITING FOR " + (settings.engine === 'uv' ? 'UV' : 'SJ') + " CORE SCRIPTS...";
            }
        }, 2000);
    </script>
</body>
</html>
